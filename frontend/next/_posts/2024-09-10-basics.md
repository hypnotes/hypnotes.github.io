---
layout: post
title: ì†ì— ìµëŠ” Next.js - Part 1 - ê³µì‹ ë¬¸ì„œ í›‘ì–´ë³´ê¸°
description: >
  í•˜ì¡°ìš´ë‹˜ ê°•ì˜, ê³µì‹ë¬¸ì„œ 13 ë”°ë¼ê°€ê¸°
categories: javascript
accent_color: "#D0C8B6"
accent_image:
  background: "#E2DAD5"
theme_color: "#D0C8B6"
sitemap: false
permalink: /frontend/next/basics
---

- add table of contents
  {:toc}

## ì™œ Next.jsë¥¼ ë°°ìš°ëŠ”ê°€?

**Next.js ë¥¼ ë°°ìš°ëŠ” ì´ìœ **

- `JS` (1995) : ëª¨ì¹´ë¡œ ë“±ì¥í–ˆë‹¤ê°€ Javaë„¤ì´ë°ìœ¼ë¡œ ì¸ê¸° ì–»ê³ ì ì´ë˜ë¨
- `Jquery` (2005) : made to handle JS easier, UI ì¡°ì‘ easy (data ê´€ë¦¬ ì–´ë ¤ì›€)

Frameworks ë“±ì¥ (Backbone, AmberJS )

- `Angular` (2010, Google) : ì–‘ë°©í–¥ (DOM <-> ë°ì´í„°) ë°ì´í„° ê´€ë¦¬ (BUT ë³µì¡ë„ ì¦ê°€í•¨)
- `React` (2013, Facebook) : ë‹¨ë°©í–¥ (ë°ì´í„° ë‚´ë ¤ë°›ê³  í•„ìš”í•˜ë©´ DOM ê°ˆì•„ë¼ìš°ê¸°!)

**React í•œê³„**

- CSR ì‹œ ì´ˆê¸° bundle too big
- SEO ì–´ë ¤ì›€ (ë´‡ë“¤ì´ js bundle ë¡œë“œ ì „ì— htmlì ‘ê·¼ ì–´ë ¤ì›€)

- `NextJs` (2016, Vercel) : SSR ê°€ëŠ¥!

## Next.js ê¸°ë³¸ ë°°ìš°ê¸°

---

### NextJS ëŠ” ë¬´ì—‡ì¸ê°€

> ë¬´ìŠ¨ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ”ê°€? <br/>**React ê°œë°œì— í•„ìš”í•œ ì„ íƒì„ ìµœì†Œí™”, ìµœì í™”**

- íŒŒì¼ ê¸°ë°˜ ë¼ìš°íŒ…
- í˜ì´ì§€ ë‹¨ìœ„ì˜ ì‚¬ì „ë Œë”ë§ (pre-rendering) SSR, SSG
- splitting ì•Œì•„ì„œ
- prefetching made easy ...etc

### **ğŸ’¦ Hydration**ì´ë€

- process of turning static HTML interactive on the client side (attaching event listeners, states...etc)

1. ì„œë²„ì—ì„œ static HTML ìƒì„±
2. ì´ˆê¸° ë Œë”ë¥¼ ìœ„í•´ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡
3. JS bunldle ë¡œë“œ
4. í´ë¼ì´ì–¸íŠ¸ì—ì„œ hydration

- attching event listeners, states...etc
- reconciling server-rendered HTML with client-side React Component tree

### NextJS 13

- file system routing ì§€ì›

- AS-IS: `pages/` ë””ë ‰í† ë¦¬ë‚´ë¡œ í•¨
- TO-BE: `apps/` **<fontcolor>App Router</fontcolor>**

  - (2022 NextJS Conf)

**hydration**

- ì „: í˜ì´ì§€ ë‹¨ìœ„ ê°€ëŠ¥
- í›„: `Streaming` ì»´í¬ë„ŒíŠ¸ ë‹¨ìœ„ë¡œ ê°€ëŠ¥ (ë¶€ë¶„ì  í•˜ì´ë“œë ˆì´ì…˜ ê°€ëŠ¥)

- ìœ ì €ê°€ ì´ˆê¸°ì— ë°›ì•„ë“œë ¤ì•¼ í•˜ëŠ” ì–‘ì´ í˜„ì €íˆ ì¤„ì–´ë“¦

### Server Components

> **RSC** (React Server Component)
> <br/>- also included in React 18

Usefulness

- Data fetching : fast
- security : only kept in server
- caching
- js bundle size decreased

| server components     | client components                                                         |
| --------------------- | ------------------------------------------------------------------------- |
| - NEXTJS 13 ë¶€í„° ê¸°ë³¸ | - ê¸°ì¡´ tranditional ì»´í¬ë„ŒíŠ¸ <br/>- ì‚¬ìš© í•„ìš” ì‹œ 'use client' í•´ì£¼ì–´ì•¼ í•¨ |

- âš ï¸ ì„œë²„ ì»´í¬ë„ŒíŠ¸ëŠ” client component ì—ì„œ Import ë¶ˆê°€!
- propsë¡œ ë„˜ê²¨ì£¼ì–´ì•¼ í•œë‹¤

- Client Component != CSR (Client-only)

  - more like 'Classic' Component
  - NextJsì˜ prerendering ìœ¼ë¡œ ë Œë” ë˜ì—ˆë˜ ì»´í¬ë„ Client Component
  - SSR, SSG ê°€ëŠ¥
  - Vs RSC? $$\rightarrow$$ usefulness ì°¸ê³ 

- Server Component
  - **hook, event ì‚¬ìš© ë¶ˆê°€**
  - $$\rightarrow$$ client component ë¥¼ ê°€ëŠ¥í•œ ìµœëŒ€ íŠ¸ë¦¬ì˜ leafë¡œ ë³´ë‚´ê¸°

### Routing

- url path (segement ë‹¨ìœ„ë¡œ)
- íŠ¹ë³„íˆ ì •í•´ì ¸ ìˆëŠ” names
  - `/error.tsx`
  - `/loading.tsx`
  - `/page.tsx`
- dyanmic routing (`app/blog/[id]/page.tsx`)

### í˜ì´ì§€ ê°„ ì´ë™

1. next/linkì˜ `<Link/>` ì‚¬ìš©
2. next/navigationì˜ `useRouter` ì‚¬ìš© (Client Componentì—ì„œë§Œ ì‚¬ìš©)

### Styling

- css modules (ë§Œ ì„¤ëª…)

  - className ì¤‘ë³µ ë°©ì§€ìœ„í•œ ì§€ì—­ ìŠ¤ì½”í”„ (`.module.css`)

- ì „ì—­ ìŠ¤íƒ€ì¼ë§
  - í´ë˜ìŠ¤ ì˜¤ì—¼ì€ ìˆê¸´ í•˜ë‚˜ ì˜ ì‚¬ìš©í•˜ë©´ êµ³ (ê°€ì¥ ìƒìœ„ì— ì“°ëŠ”ê±¸ ì¶”ì²œ (like layout))

### Data Fetching

- nextì—ì„œ ì œê³µí•˜ëŠ” `fetch` ì‚¬ìš© ê°€ëŠ¥
  - Server Component, Client Component, APIë„ ê°€ëŠ¥
  - Data ìºì‹±ë¨!! (**<fontcolor>ë³´ë¼ìƒ‰</fontcolor>** ë¶€ë¶„)

![image](https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fcaching-overview.png&w=3840&q=75){:.lead width="200" height="100" loading="lazy"}
[NextJS Caching](https://nextjs.org/docs/app/building-your-application/caching)
{:.figcaption}

revalidation (ì¬ê²€ì¦)

1. â° **ì‹œê°„ ê¸°ë°˜ ì¬ê²€ì¦** :

   ```js
   // ex: 1hour ìœ íš¨
   fetch("https://...", { next: { revalidate: 3600 } });
   ```

   ![image](https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ftime-based-revalidation.png&w=3840&q=75){:.lead width="200" height="100" loading="lazy"}

   - âš ï¸ `stale` íŒì •ë˜ë©´ revalidate í•˜ì§€ë§Œ, ëŒë ¤ì£¼ëŠ” ê°’ì€ staleê°’ì„
   - ë‹¤ìŒ í˜¸ì¶œë•Œ ì‹ ì„ í•œ ë°ì´í„° ì¤Œ

2. ì˜¨ë””ë§¨ë“œ (ìˆ˜ìš” ìˆì„ ë–„)

- tagê¸°ë°˜, path ê¸°ë°˜
- Tag ê¸°ë°˜:

  ```js
  // ex: 1hour ìœ íš¨
  fetch("https://...", { next: { tags: ["collection"] } });

  revalidateTag("collection");
  ```

  ![image](https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fon-demand-revalidation.png&w=3840&q=75){:.lead width="200" height="100" loading="lazy"}

  - revalidate ì‹œ `PURGE` (ì •ë¦¬)
  - next fetch: fresh data

### Metadata

- page thumnail, description etc

1. Static Metadata: metatdata ê°ì²´ ì •ì˜

   ```js
   import type { Metadata } from "next";
   export const metadata: Metadata = {
     title: "...",
     description: "...",
   };

   export default function Page() {}
   ```

2. Dynamic Metadata: ë™ì ìœ¼ë¡œ metadata obj ìƒì„±

   ```js
   import type { Metadata, ResolvingMetadata } from "next";

   export async function generateMetadata(
     { params, searchParams }: Props,
     parent?: ResolvingMetadata
   ): Promise<Metadata> {
     const id = params.id;
     const post = await fetch(`https://../${id}`).then((res) => res.json());
     const prevImages = (await parent).openGraph?.images || [];

     // METADATAê°€ ë¨
     return {
       title: post.title,
       openGraph: {
         images: ["/asdfasdf.jpg", ...prevImages],
       },
     };
   }
   ```
