---
layout: post
title: Routing and Page Rendering
description: >
  ë¼ìš°íŒ… ë° í˜ì´ì§€ ë Œë”ë§ - ì‹¬ì¸µë¶„ì„
categories: next
accent_color: "#FFF"
accent_image:
  background: "#000"
theme_color: "#000"
sitemap: false
permalink: /frontend/next/routing
---

- `app/icon.jpg` $$\rightarrow$$ ì¦‰ì‹œ faviconìœ¼ë¡œ ì‚¬ìš©
- ëª¨ë“  page component ì— ì•”ë¬µì ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” Param ìˆìŒ -> ë™ì  ë¼ìš°íŒ… ê°€ëŠ¥

### âˆ¥ Parallel Routes

> ë³‘ë ¬ ë¼ìš°íŠ¸

- `@` ì²˜ë¦¬

```
archive/
â”œâ”€â”€ @latest/
â”‚   â””â”€â”€ page.ts
â”œâ”€â”€ @archive/
â”‚   â”œâ”€â”€ page.ts
â”‚   â””â”€â”€ [slug]/
â”‚       â””â”€â”€ page.ts
â””â”€â”€ layout.ts
```

- ìë™ìœ¼ë¡œ layout paramìœ¼ë¡œ ë“¤ì–´ê° !

  ```js
  const ArchiveLayout({archive, layout}) => {
    return (
      <>
        {archive}
        {latest}
      </>
    )
  }
  ```

  - ë¬¸ì œ: `/archive/1211` ë¶ˆê°€ (latest > [slug]ê°€ ì—†ìŒ)
  - í•´ê²°: `latest/default.ts`
    - ë³‘ë ¬ ë¼ìš°íŒ… ë˜ë”ë¼ë„ ì–˜ ë³´ì—¬ì¤Œ (no matter which slug)

### ğŸ£ Catch-All Routing

- layoutì— navbar ë„£ëŠ” ëŒ€ì‹  ì´ê±° í•´ë„ ì¢‹ìŒ

```
archive/
â”œâ”€â”€ @archive/
â”‚   â”œâ”€â”€ [[...filter]] <<<<<<<<<----- Catch-all
â”‚   â”‚    â””â”€â”€ page.ts
â””â”€â”€ layout.ts
```

- catches **ALL** params after archive/
  - `archive/`, `archive/2024`, `archive/2024/12112`

### Error.tsx

- ì˜ëª»ëœ url ì…ë ¥í•´ì„œ paramsì—ì„œ ê°ì§€ ë¶ˆê°€ ì‹œ, `throw Error`ì„ í•œë‹¤ê³  í•˜ì
- Error.ts íŒŒì¼ì„ ìƒì„±í•´ë‘ë©´ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ ë¨ (ì—ëŸ¬ ëŒ€ì‹ )

> âš ï¸ ë°˜ë“œì‹œ "use client"ë¡œ ë§Œë“¤ ê²ƒ
> error may work on both ends, (client components works on both ends) => error fallback must be availabe on both sides

---

#### Revisiting Server vs Client Components

| React Server Components (RSC) | Client Components                               |
| ----------------------------- | ----------------------------------------------- |
| ONLY rendered on server       | pre-rendered in server, <br/> clientì—ì„œë„ ê°€ëŠ¥ |
| default in NEXTJS             |                                                 |

- `error.ts`, `usePathName()` ê°™ì€ í›… ì‚¬ìš©í•˜ë ¤ë©´ "use client"ë¡œ í•´ì„œ client componentë¡œ ë³€ê²½í•´ì•¼ í•¨
- ìµœëŒ€í•œ further down the treeë¡œ...

### Nested Dynamic Routing, Intercepting

- `posts/[id]/images` ìš”ëŸ°ê±° ê°€ëŠ¥

- Intercepting Routes

  ```
  posts/
  â”œâ”€â”€ [id]/
  â”‚   â”œâ”€â”€ (.)images/ <<<<<<<----- intercept ë¡œ ì§„ì… ê²½ìš°
  |   |   â””â”€â”€ page.tsx
  â”‚   â””â”€â”€ images/
  â”‚       â””â”€â”€ page.tsx
  â””â”€â”€ layout.ts
  ```

  - parellel ë¼ìš°íŒ… ì‚¬ìš© ì‹œ íŠ¹íˆ ìœ ìš©í•¨ (ëª¨ë‹¬ vs full screen)

  ```
  posts/
  â”œâ”€â”€ [id]/
  â”‚   â”œâ”€â”€ @modal
  |   |   â””â”€â”€ (.)images
  |   |        â””â”€â”€ page.tsx (must return at least null)
  |   |   â””â”€â”€ page.tsx
  â”‚   â””â”€â”€ images/
  â”‚       â””â”€â”€ page.tsx
  â””â”€â”€ layout.ts (modal ì¶”ê°€)
  ```

- ì˜¤ë¥˜ ë°œìƒí•  ìˆ˜ë„ ìˆìŒ
  - í•´ê²°: `page.tsx` -> `default.tsx`ë¡œ ë³€ê²½í•´ë³´ê¸°

### next/useRouter

- `useRouter`ë¡œ ë¼ìš°í„° ì •ë³´ ê°€ì ¸ì˜¤ê¸°

  - `use client`ë¡œ ë§Œë“¤ì–´ì•¼ í•¨

  ```js
  const router = useRouter();
  const goBack = () => router.back();
  ```

### Route Groups

```
app/
â”œâ”€â”€ posts/ ...
â”œâ”€â”€ page.tsx
â””â”€â”€ layout.tsx
```

- `(ROUTE GROUP)`ì€ urlì— ì ìš©ë˜ì§€ ì•ŠìŒ
- ì˜ˆ) ìµœìƒìœ„ layout.tsxì— ë„¤ë¹„ê²Œì´ì…˜ë°”ê°€ ìˆìœ¼ë‚˜ ëœë”©í˜ì´ì§€ (page.tsx) ì—ëŠ” ë¹¼ê³  ì‹¶ì„ ë•Œ:

```
app/
â”œâ”€â”€ (content)/  ( ROUTE GROUP )
â”‚   â”œâ”€â”€ posts/ ...
â”‚   â””â”€â”€ layout.tsx  <<<<<<<----- ë„¤ë¹„ê²Œì´ì…˜ í¬í•¨
â””â”€â”€ (landing)/ ...  ( ROUTE GROUP )
    â””â”€â”€ page.tsx    <<<<<<<----- ì—¬ê¸° landí•¨
    â””â”€â”€ layout.tsx  <<<<<<<----- ë„¤ë¹„ê²Œì´ì…˜ ë¹ ì§„ ë ˆì´ì•„ì›ƒ
```

#### Route Handlers

- ex: `api/route.ts`
- ë”°ë¡œ Page.tsxë‚˜ layout.tsx ë¶ˆí•„ìš” (í˜ì´ì§€ë¥¼ ë Œë”ë§ í•˜ì§€ ì•ŠìŒ)
- exports GET, POST, PUT, DELETE, PATCH í•˜ëŠ” í•¨ìˆ˜ë“¤

```js
export async function GET(request) {
  console.log("GET request", request);

  return new Response("Hello World");
}
```

- localhost:3000/api ë¡œ ì ‘ê·¼ ì‹œ Hello World ì¶œë ¥
- í„°ë¯¸ë„ì—ì„œëŠ” `GET request` ì¶œë ¥

#### MiddleWares, matchers

- does NOT use app/
- `middleware.ts` íŒŒì¼ ìƒì„±

```js
import { NextResponse } from "next/server";

export const middleware = (request) => {
  // forwards to next middleware
  return NextResponse.next();
};
```

- then it would run for ALL requests sent to the server (including image fetches, etc.)

```js
export const config = {
  matcher: "/posts",
};
```

- only runs for requests that match the given path
